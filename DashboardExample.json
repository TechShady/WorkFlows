{"version":21,"variables":[],"tiles":{"15":{"title":"Service Summary","type":"data","query":"timeseries {latency_p50 = median(dt.service.request.response_time),\n           latency_p90 = percentile(dt.service.request.response_time, 90),\n           latency_p99 = percentile(dt.service.request.response_time, 99),\n           requests = sum(dt.service.request.count), \n           errors = sum(dt.service.request.failure_count)},\n           by:{dt.entity.service}\n\n| lookup [ timeseries latency_avg = avg(dt.service.request.response_time),\n           by:{dt.entity.service}],\n            sourceField:dt.entity.service, lookupField:dt.entity.service,\n            prefix: \"latencyAvg.\"\n\n\n\n| lookup [ timeseries http_5xx = sum(dt.service.request.count,default: 0.0),\n           by:{dt.entity.service},\n           filter: (http.response.status_code >= 500 and http.response.status_code <= 599) ],\n            sourceField:dt.entity.service, lookupField:dt.entity.service,\n            prefix: \"http5xx.\"\n\n| lookup [ timeseries http_4xx = sum(dt.service.request.count,default: 0.0),\n           by:{dt.entity.service},\n           filter: (http.response.status_code >= 400 and http.response.status_code <= 499) ],\n            sourceField:dt.entity.service, lookupField:dt.entity.service,\n            prefix: \"http4xx.\"\n\n| lookup [fetch dt.davis.problems, from:now()-7h, to:now()\n         | filter event.status==\"ACTIVE\" and dt.davis.is_duplicate==false// and matchesPhrase(affected_entity_ids, \"SERVICE-\")\n         | expand affected_entity_ids\n         | summarize {Problems = countDistinct(display_id),\n               event.id = takeFirst(event.id),\n               event.kind = takeFirst(event.kind)}, \n               by:{affected_entity_ids}],\n  sourceField:dt.entity.service, lookupField:affected_entity_ids, \n  fields:{Problems, affected_entity_ids,event.id,event.kind}    \n\n| fieldsAdd Latency_Avg = arrayAvg(latencyAvg.latency_avg),\n            Latency_p50 = arrayAvg(latency_p50),\n            Latency_p90 = arrayAvg(latency_p90),\n            Latency_p99 = arrayAvg(latency_p99),\n            Requests = arraySum(requests), \n            Failures = arraySum(errors),\n           `5xx` = arraySum(http5xx.http_5xx),\n           `4xx` = arraySum(http4xx.http_4xx) \n| fieldsAdd FailureRate = (Failures/Requests) *100\n| fieldsAdd Service = entityName(dt.entity.service)\n| fieldsAdd dt.entity.process_group = entityAttr(dt.entity.service, \"runs_on\")\n| fieldsAdd dt.entity.process_group = dt.entity.process_group[dt.entity.process_group]\n| fieldsAdd LogQueryPart2 = \"\"\"\\\")\"\"\" \n| fieldsAdd LogQueryPart2 = encodeUrl(LogQueryPart2)\n| fields Status = if(Problems >= 0 , \"PROBLEM\",  else: \"HEALTHY\"),\n         Service,\n         dt.entity.service,\n         StatusSort = if(Problems > 0, 0, else: 1),\n         Requests,\n         Latency_Avg,\n         Latency_p50,\n         Latency_p90,\n         Latency_p99,\n         FailureRate,\n         Failures,\n        `5xx` = if(isNull(`5xx`), 0, else:`5xx`),\n        `4xx` = if(isNull(`4xx`), 0, else:`4xx`),\n         event.id,\n         event.kind\n| sort StatusSort asc\n| fieldsRemove StatusSort\n| limit 1000","visualization":"table","visualizationSettings":{"table":{"colorThresholdTarget":"background","hiddenColumns":[["dt.entity.service"],["event.id"],["event.kind"]],"selectedColumnForRowThreshold":"FailureRate","columnTypeOverrides":[{"id":803368.3000000119,"fields":["Analyze Errors"],"value":"markdown"},{"id":191362.59999996424,"fields":["Service"],"value":"markdown"}],"columnOrder":["[\"Status\"]","[\"Service\"]","[\"dt.entity.service\"]","[\"Requests\"]","[\"Latency_Avg\"]","[\"Latency_p50\"]","[\"Latency_p90\"]","[\"Latency_p99\"]","[\"FailureRate\"]","[\"Failures\"]","[\"5xx\"]","[\"4xx\"]","[\"event.id\"]","[\"event.kind\"]"]},"autoSelectVisualization":false,"thresholds":[{"id":1,"field":"Status","title":"","isEnabled":true,"rules":[{"id":0,"color":"#0D9C29","comparator":"=","label":"","value":"HEALTHY"},{"id":2,"color":"#AE132D","comparator":"=","label":"","value":"PROBLEM"}]},{"id":2,"field":"Failures","title":"","isEnabled":true,"rules":[{"id":0,"color":"#0D9C29","comparator":"≥","label":"","value":0},{"id":1,"color":{"Default":"var(--dt-colors-charts-categorical-color-14-default, #d56b1a)"},"comparator":"≥","label":""},{"id":2,"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"comparator":"≥","label":"","value":1}]},{"id":6,"field":"FailureRate","title":"","isEnabled":true,"rules":[{"id":0,"color":"#0D9C29","comparator":"≥","label":"","value":0},{"id":1,"color":{"Default":"var(--dt-colors-charts-categorical-color-14-default, #d56b1a)"},"comparator":"≥","label":""},{"id":2,"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"comparator":"≥","label":"","value":2}]},{"id":7,"field":"Requests","title":"","isEnabled":false,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"≥","label":"","value":0}]},{"id":8,"field":"5xx","title":"","isEnabled":true,"rules":[{"id":0,"color":"#0D9C29","comparator":"≥","label":"","value":0},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"≥","label":""},{"id":2,"color":"#C21930","comparator":"≥","label":"","value":1}]},{"id":9,"field":"4xx","title":"","isEnabled":true,"rules":[{"id":0,"color":"#0D9C29","comparator":"≥","label":"","value":0},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"≥","label":""},{"id":2,"color":"#C21930","comparator":"≥","label":"","value":1}]}],"unitsOverrides":[{"identifier":"Latency_p50","unitCategory":"time","baseUnit":"microsecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1714406730982},{"identifier":"Latency_p90","unitCategory":"time","baseUnit":"microsecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1715002954070},{"identifier":"Latency_p99","unitCategory":"time","baseUnit":"microsecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1715003431114},{"identifier":"Requests","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1718630613563},{"identifier":"Failures","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1718630622004},{"identifier":"5xx","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1718853295595},{"identifier":"4xx","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1721450903714},{"identifier":"FailureRate","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1721451329942},{"identifier":"Latency_Avg","unitCategory":"time","baseUnit":"microsecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1745640126767}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"16":{"title":"","type":"data","query":"data record(a=\"SERVICE SUMMARY\")","visualization":"singleValue","visualizationSettings":{"singleValue":{"labelMode":"none","label":" ","recordField":"a","prefixIcon":"ServicesIcon","colorThresholdTarget":"background","trend":{"isVisible":true}},"thresholds":[{"id":1,"field":"a","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"!=","label":"","value":"0"}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"21":{"title":"Services  Current Status","type":"data","query":"fetch dt.entity.service\n| filter serviceType != \"DATABASE_SERVICE\"\n| lookup [\n  fetch dt.davis.problems\n  | filter event.status == \"ACTIVE\"\n  | expand affected_entity_ids\n], sourceField:id, lookupField:affected_entity_ids\n| fieldsAdd affected = if(isNotNull(lookup.affected_entity_ids), \"Problem\", else: \"Healthy\")\n| fields affected, \n         id, \n         entity.name, \n         event.id = lookup.event.id, \n         event.kind = lookup.event.kind\n| sort affected desc\n","visualization":"honeycomb","visualizationSettings":{"honeycomb":{"legend":{"hidden":true},"dataMappings":{"value":"affected"},"displayedFields":["entity.name"],"colorMode":"custom-colors","customColors":[{"id":0,"value":"Problem","comparator":"=","color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"}},{"id":2550753.899999991,"value":"Healthy","comparator":"=","color":"#0D9C29"}]},"autoSelectVisualization":false,"thresholds":[]},"querySettings":{"maxResultRecords":2000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"timeframe":{"tileTimeframe":{"from":"now()-7h","to":"now()"},"tileTimeframeEnabled":true}},"22":{"title":"Problems List","type":"data","query":"fetch dt.davis.problems\n| filter `dt.davis.is_duplicate` == false\n| sort timestamp desc\n| expand affected_entity_ids\n| lookup [fetch dt.entity.service], sourceField:affected_entity_ids, lookupField: id, prefix:\"lookup.affected.entity.services\"\n| lookup [fetch dt.entity.process_group_instance], sourceField:affected_entity_ids, lookupField: id, prefix:\"lookup.affected.entity.pgi\"\n| lookup [fetch dt.entity.application], sourceField:affected_entity_ids, lookupField: id, prefix:\"lookup.affected.entity.applications\"\n| lookup [fetch dt.entity.mobile_application], sourceField:affected_entity_ids, lookupField: id, prefix:\"lookup.affected.entity.mobile\"\n| lookup [fetch dt.entity.custom_application], sourceField:affected_entity_ids, lookupField: id, prefix:\"lookup.affected.entity.customapplication\"\n| lookup [fetch dt.entity.cloud_application], sourceField:affected_entity_ids, lookupField: id, prefix:\"lookup.affected.entity.cloudapplication\"\n| lookup [fetch dt.entity.synthetic_test], sourceField:affected_entity_ids, lookupField: id, prefix:\"lookup.affected.entity.synthetictest\"\n| lookup [fetch dt.entity.http_check], sourceField:affected_entity_ids, lookupField: id, prefix:\"lookup.affected.entity.httpcheck\"\n| lookup [fetch dt.entity.multiprotocol_monitor], sourceField:affected_entity_ids, lookupField: id, prefix:\"lookup.affected.entity.multiprotocolmonitor\"\n| lookup [fetch dt.entity.kubernetes_cluster], sourceField:affected_entity_ids, lookupField: id, prefix:\"lookup.affected.entity.kubernetescluster\"\n| lookup [fetch dt.entity.host], sourceField:affected_entity_ids, lookupField: id, prefix:\"lookup.affected.entity.hosts\"\n| lookup [fetch dt.entity.custom_device], sourceField:affected_entity_ids, lookupField: id, prefix:\"lookup.affected.entity.customdevices\"\n| lookup [fetch dt.entity.hypervisor], sourceField:affected_entity_ids, lookupField: id, prefix:\"lookup.affected.entity.hypervisor\"\n| lookup [fetch dt.entity.environment], sourceField:affected_entity_ids, lookupField: id, prefix:\"lookup.affected.entity.environment\"\n| summarize {startTime = takeFirst(event.start),\n            endTime = takeFirst(event.end),\n            problemClosedDuration = takeFirst(resolved_problem_duration),\n            status = takeFirst(event.status),\n            event.name = takeFirst(event.name),\n            severityLevel = takeFirst(event.category),\n            affected = takeFirst(affected_entity_ids),\n            rootCause = takeFirst(root_cause_entity_name),\n            dt.davis.is_duplicate = takeFirst(dt.davis.is_duplicate),\n            affectedServices = collectDistinct(lookup.affected.entity.servicesentity.name),\n            affectedPGI = collectDistinct(lookup.affected.entity.pgientity.name),\n            affectedApplications = collectDistinct(lookup.affected.entity.applicationsentity.name),\n            affectedMobile = collectDistinct(lookup.affected.entity.mobileentity.name),\n            affectedCustomApplication = collectDistinct(lookup.affected.entity.customapplicationentity.name),\n            affectedCloudApplication = collectDistinct(lookup.affected.entity.cloudapplicationentity.name),\n            affectedSyntheticTest = collectDistinct(lookup.affected.entity.synthetictestentity.name),\n            affectedHttpCheck = collectDistinct(lookup.affected.entity.httpcheckentity.name),\n            affectedMultiprotocolMonitor = collectDistinct(lookup.affected.entity.multiprotocolmonitorentity.name),\n            affectedKubernetesCluster = collectDistinct(lookup.affected.entity.kubernetesclusterentity.name),\n            affectedHosts = collectDistinct(lookup.affected.entity.hostsentity.name),\n            affectedCustomDevices = collectDistinct(lookup.affected.entity.customdevicesentity.name),\n            affectedHypervisor = collectDistinct(lookup.affected.entity.hypervisorentity.name),\n            affectedEnvironment = collectDistinct(lookup.affected.entity.environmententity.name),\n            event.id = takeFirst(event.id)}, \n            by:{display_id, event.kind}\n| fieldsAdd currentTime = toTimestamp(now())\n| fieldsAdd Description = concat(display_id,\" - \",event.name)\n| fields Status = status,       \n         Description,\n         Affected = arrayRemoveNulls(arrayConcat(affectedApplications,affectedMobile,affectedCustomApplication,affectedCloudApplication,affectedSyntheticTest,affectedHttpCheck,affectedServices,affectedPGI,affectedKubernetesCluster,affectedHosts,affectedHypervisor,affectedCustomDevices,affectedEnvironment,affectedMultiprotocolMonitor)),\n         RootCause = if(isNotNull(rootCause), rootCause, else:\"\"),\n         StartTime = startTime,\n         EndTime =  if((status == \"ACTIVE\"),\"In Progress\", \n                    else:if((status == \"CLOSED\"),endTime)),   \n         Duration = if((status == \"CLOSED\"),problemClosedDuration,\n                    else:if((status == \"ACTIVE\"), currentTime-startTime)),\n         event.id,\n         event.kind\n| sort StartTime, direction:\"descending\"\n| sort Status, direction:\"ascending\"\n","visualization":"table","visualizationSettings":{"table":{"colorThresholdTarget":"background","hiddenColumns":[["event.id"],["event.kind"]],"linewrapEnabled":true,"rowDensity":"default","lineWrapIds":[["Description"],["Affected"]],"selectedColumnForRowThreshold":"Status","columnWidths":{"[\"Status\"]":91,"[\"Problem\"]":290,"[\"Affected\"]":321,"[\"RootCause\"]":248,"[\"StartTime\"]":144,"[\"EndTime\"]":211,"[\"Duration (min)\"]":141,"[\"event.id\"]":301},"sortBy":[{"columnId":"[\"RootCause\"]","direction":"descending"}],"columnTypeOverrides":[{"id":420834.90000000596,"fields":["Description"],"value":"markdown"}]},"thresholds":[{"id":1,"field":"Status","title":"","isEnabled":true,"rules":[{"id":0,"color":"#0D9C29","comparator":"=","label":"","value":"CLOSED"},{"id":2,"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"comparator":"=","label":"","value":"ACTIVE"}]}],"unitsOverrides":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"davisVisualization":{}}},"23":{"title":"","type":"data","query":"data record(a=\"METRICS\" )","visualization":"singleValue","visualizationSettings":{"singleValue":{"labelMode":"none","label":"a","recordField":"a","prefixIcon":"LineChartIcon","colorThresholdTarget":"background","trend":{"isVisible":true}},"thresholds":[{"id":1,"field":"a","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"!=","label":"","value":"0"}]}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"24":{"title":"Service - Latency","description":"Response time of a service measured in microseconds on the server side (server side measurements do not include e.g. proxy and networking times). Response time is the time until a response is sent to a calling application, process or other service. It does not include further asynchronous processing. ","type":"data","query":"timeseries latency_p50 = percentile(dt.service.request.response_time, 50)\n","visualization":"lineChart","visualizationSettings":{"chartSettings":{"truncationMode":"middle","legend":{"hidden":true},"leftYAxisSettings":{"label":"Service request response time"},"xAxisLabel":"timeframe","xAxisScaling":"analyzedTimeframe","fieldMapping":{"leftAxisValues":["latency_p50"],"timestamp":"timeframe"},"gapPolicy":"connect"},"thresholds":[],"unitsOverrides":[{"identifier":"Availability","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1714406692260},{"identifier":"Performance","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1714406706391},{"identifier":"Latency","unitCategory":"time","baseUnit":"microsecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1714406730982}],"dataMapping":{"displayedFields":["latency_p50"]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}}},"layouts":{"15":{"x":0,"y":6,"w":24,"h":5},"16":{"x":0,"y":5,"w":24,"h":1},"21":{"x":0,"y":0,"w":9,"h":5},"22":{"x":9,"y":0,"w":15,"h":5},"23":{"x":0,"y":11,"w":24,"h":1},"24":{"x":0,"y":12,"w":24,"h":8}},"importedWithCode":false,"settings":{"gridLayout":{"mode":"responsive"}},"annotations":[]}